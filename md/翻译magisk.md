# é¢å…·

## å®‰è£…

å¦‚æœæ‚¨å·²ç»å®‰è£…äº†Magiskï¼Œåˆ™ å¼ºçƒˆå»ºè®® ä½¿ç”¨Magiskåº”ç”¨ç¨‹åºçš„â€œç›´æ¥å®‰è£…â€æ–¹æ³•ç›´æ¥è¿›è¡Œå‡çº§ã€‚ ä»¥ä¸‹æ•™ç¨‹ä»…é€‚ç”¨äºåˆå§‹å®‰è£…ã€‚
å…¥é—¨

åœ¨ä½ å¼€å§‹ä¹‹å‰ï¼š

    æœ¬æ•™ç¨‹å‡å®šæ‚¨äº†è§£å¦‚ä½•ä½¿ç”¨ adb å’Œ fastboot
    æ‚¨è®¾å¤‡çš„å¼•å¯¼åŠ è½½ç¨‹åºå¿…é¡»è§£é”
    åœ¨å®‰è£…Magiskä¹‹å‰ï¼Œè¯·ç¡®ä¿åˆ é™¤æ‰€æœ‰â€œå¼•å¯¼æ˜ åƒæ¨¡å—â€ï¼Œä¾‹å¦‚å…¶ä»–æ ¹è§£å†³æ–¹æ¡ˆã€‚ æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨å·¥å‚æ˜ åƒè¿˜åŸå¯åŠ¨æ˜ åƒï¼Œæˆ–é‡æ–°åˆ·æ–° æœªé¢„rootçš„ è‡ªå®šä¹‰ROM
    å¦‚æœæ‚¨è¿˜æ‰“ç®—å®‰è£…è‡ªå®šä¹‰å†…æ ¸ï¼Œè¯·åœ¨Magiskä¹‹åå®‰è£…

ä¸‹è½½å¹¶å®‰è£…æœ€æ–°çš„Magiskåº”ç”¨ç¨‹åºã€‚ æˆ‘ä»¬ä½¿ç”¨è¯¥åº”ç”¨ç¨‹åºæ”¶é›†æœ‰å…³æ‚¨è®¾å¤‡çš„ä¸€äº›ä¿¡æ¯ã€‚ åœ¨ä¸»å±å¹•ä¸­ï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼š

æ³¨æ„è¿™ä¸ªRamdisk infoã€‚å¦‚æœæ˜¯yes æˆ–è€…æ˜¯â€˜æ˜¯â€™ï¼Œæ­å–œä½ ï¼Œä½ çš„è®¾å¤‡å¯ä»¥å®Œç¾çš„å®‰è£…Magiskã€‚å½“ç„¶äº†ï¼Œå¦‚æœç»“æœæ˜¯noï¼Œæ„å‘³ç€ä½ çš„è®¾å¤‡å¯åŠ¨åˆ†åŒºä¸åŒ…å«ramdiskã€‚è¿™æ„å‘³ç€ä½ éœ€è¦ä¸€äº›é¢å¤–çš„æ­¥éª¤æ¥è®©magiskæ­£å¸¸å·¥ä½œã€‚

    å¦‚æœä½ çš„è®¾å¤‡ä¸åŒ…å«ramdiskï¼Œé˜…è¯»â€œå®‰è£…â€åé¢çš„â€œRecoveryâ€ç« èŠ‚ã€‚è¿™é‡Œé¢çš„ä¸œè¥¿å¾ˆé‡è¦ã€‚

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ä¸‰æ˜Ÿæˆ–è€…åä¸ºï¼Œè€Œä¸”â€œSARâ€ çš„ç»“æœæ˜¯yesï¼Œè¯·é˜…è¯»ç›¸å…³ç« èŠ‚ã€‚

å¦åˆ™ï¼Œç›´æ¥å»â€œPatching Imagesâ€ç« èŠ‚ã€‚

(P.S.1 å¦‚æœä½ çš„è®¾å¤‡æœ‰ramdiskï¼Œä½ å¯ä»¥é€šè¿‡â€œCustom Recoveryâ€æ¥å®‰è£…)ï¼ˆæœ¬äººè¯•éªŒè¿‡äº†ï¼Œå¤±è´¥ï¼‰
(P.S.2 å¦‚æœä½ å¯¹å®‰å“æ˜¯å¦‚ä½•å¯åŠ¨çš„ï¼Œå’Œmagiskæ˜¯å¦‚æœèµ·ä½œç”¨çš„ï¼Œå¯ä»¥é˜…è¯»è¿™ç¯‡æ–‡ç« [https://topjohnwu.github.io/Magisk/boot.html])

## Patching Images

å¦‚æœä½ çš„è®¾å¤‡æœ‰ramdiskï¼Œä½ éœ€è¦å¤åˆ¶ä¸€ä»½boot.img

å¦‚æœä½ çš„è®¾å¤‡æ²¡æœ‰ramdiskï¼Œä½ éœ€è¦å¤åˆ¶ä¸€ä»½recovery.imgã€‚

ä½ åº”è¯¥åˆ°å®˜æ–¹â€œfirmwareâ€æˆ–è€…ä½ çš„è‡ªå®šä¹‰rom æ–‡ä»¶ä¸­æå–è¿™äº›æ–‡ä»¶ï¼ˆå¦‚æœä½ ç”¨äº†çš„è¯ï¼‰ï¼Œå¦‚æœä½ è¿˜æœ‰é—®é¢˜ï¼Œå¯ä»¥åˆ° XDA-Developers ï¼ˆå›½å¤–çš„ä¸€ä¸ªè®ºå›ï¼‰æŸ¥æ‰¾èµ„æºï¼ŒæŒ‡å¯¼ï¼Œè®¨è®ºï¼Œæˆ–è€…åœ¨ä½ çš„è®¾å¤‡ç›¸å…³çš„æ¿å—å¯»æ±‚å¸®åŠ©ã€‚

    Copy the boot/recovery image to your device
    Press the Install button in the Magisk card
    If you are patching a recovery image, make sure â€œRecovery Modeâ€ is checked in options.
    In most cases it should already be automatically checked.
    Choose â€œSelect and Patch a Fileâ€ in method, and select the stock boot/recovery image
    The Magisk app will patch the image to [Internal Storage]/Download/magisk_patched_[random_strings].img.
    Copy the patched image to your PC with ADB:
    adb pull /sdcard/Download/magisk_patched_[random_strings].img
    Flash the patched boot/recovery image to your device.
    For most devices, reboot into fastboot mode and flash with command:
    fastboot flash boot /path/to/magisk_patched.img or
    fastboot flash recovery /path/to/magisk_patched.img if flashing a recovery image
    Reboot and voila!ï¼ˆè¿™éƒ¨åˆ†ï¼Œè§†é¢‘ä¸­æ¼”ç¤ºäº†ï¼Œä¸æƒ³ç¿»è¯‘äº†ï¼‰

## Custom Recovery

åœ¨ä¸€äº›è‡ªå®šä¹‰recovery ï¼ˆå°±æ˜¯twrpï¼Œfoxä¹‹ç±»çš„ï¼‰ä¸­ï¼Œå®‰è£…å¯èƒ½ä¼šå¤±è´¥çš„æ‚„æ— å£°æ¯ï¼ˆçœ‹èµ·æ¥æˆåŠŸäº†ï¼Œä½†æ˜¯å¤±è´¥äº†ï¼‰ã€‚è¿™æ˜¯å› ä¸ºå®‰è£…è„šæœ¬æ— æ³•æ­£ç¡®çš„æ£€æµ‹åˆ°ä½ çš„è®¾å¤‡ä¿¡æ¯ï¼Œæˆ–è€…recovery çš„ç¯å¢ƒä¸ç¬¦åˆé¢„æœŸã€‚å¦‚æœä½ æœ‰è¿™ä¸ªé—®é¢˜ï¼Œè¯·ä½¿ç”¨â€œPatch Imageâ€ é‡Œé¢çš„æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•ç™¾åˆ†ç™¾æˆåŠŸã€‚æ­£å› å¦‚æ­¤ï¼Œä¸æ¨èåœ¨æ–°çš„è®¾å¤‡ä¸Šé€šè¿‡è¿™ç§æ–¹å¼å®‰è£…ã€‚è¿™ç§æ–¹æ³•åªé€‚åˆäºä¸€äº›â€œè€æ—§â€çš„è®¾å¤‡ã€‚

    Download the Magisk APK
    Rename the .apk file extension to .zip, for example: Magisk-v22.0.apk â†’ Magisk-v22.0.zip. If you have trouble renaming the file extension (like on Windows), use a file manager on Android or the one included in TWRP to rename the file.
    Flash the zip just like any other ordinary flashable zip.
    Warning: sepolicy.rule file of modules may be stored in cache partition, do not clear it.
    Check whether the Magisk app is installed. If it isnâ€™t installed automatically, manually install the APK.ï¼ˆè·Ÿä½ å®‰è£…ç¬¬ä¸‰æ–¹romä¸€æ ·ï¼‰

## Uninstallation/å¸è½½

æœ€å¥½çš„å¸è½½magisk çš„æ–¹æ³•å°±æ˜¯ç›´æ¥å¸è½½magisk çš„è½¯ä»¶ã€‚

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ä¸Šé¢çš„â€œCustom recoveryâ€ï¼ŒæŠŠapp å®‰è£…æ–‡ä»¶é‡å‘½åä¸ºâ€œuninstall.zipâ€ï¼Œç„¶åå°±åƒåˆ·rom ä¸€æ ·åˆ·ã€‚

## Magisk in Recovery

å¦‚æœä½ çš„è®¾å¤‡æ²¡æœ‰ramdiskï¼Œæ²¡æœ‰åŠæ³•ï¼Œmagiskï¼Œåªèƒ½å®‰è£…åˆ°recovery åˆ†åŒºã€‚å¯¹äºè¿™ç§è®¾å¤‡ï¼Œæ¯æ¬¡ä½ éœ€è¦ä½¿ç”¨magisk æ—¶éƒ½è¦é‡å¯åˆ°recoveryã€‚

å½“magisk å®‰è£…åˆ°recovery ï¼Œä½ æ— æ³•é€šè¿‡â€œcustom  recoveryâ€å®‰è£…æˆ–è€…å‡çº§magisk ï¼Œå”¯ä¸€çš„åŠæ³•æ—¶é€šè¿‡magisk çš„è½¯ä»¶ã€‚è½¯ä»¶å¯ä»¥è·å–ä½ çš„æ‰‹æœºçš„ä¿¡æ¯ï¼Œå®‰è£…åˆ°æ­£ç¡®çš„åˆ†åŒºï¼Œé‡å¯åˆ°æ­£ç¡®çš„æ¨¡å¼ã€‚

ä½ å¯ä»¥é€šè¿‡ç»„åˆé”®çš„æ–¹å¼è®©ä½ è¿›å…¥recoveryã€‚

é€šè¿‡ç»„åˆé”®ï¼Œä¼šé¦–å…ˆè¿›å…¥magiskï¼Œæ­¤æ—¶ä¸æ¾æ‰‹ç»§ç»­æŒ‰ä½ï¼Œä¼šè¿›å…¥recoveryã€‚

## Samsung (System-as-root)

å¦‚æœä½ çš„å®‰å“ç‰ˆæœ¬ä¸æ˜¯9.0 æˆ–è€…æ›´é«˜ï¼Œé‚£å°±ä¸ç”¨è¯»äº†ã€‚

åœ¨å®‰è£…é¢å…·ä¹‹å‰

    å®‰è£…é¢å…·ä¼šç§»é™¤KNOXï¼ˆä¸äº†è§£ï¼Œè¯·ç™¾åº¦ï¼‰
    ç¬¬ä¸€æ¬¡å®‰è£…é¢å…·ä¼šè¯·æ±‚æ ¼å¼åŒ–æ•°æ®ï¼ˆä¸æ˜¯æŒ‡åœ¨è§£é”bootloader æ—¶ï¼‰ã€‚åœ¨ç»§ç»­ä¸‹ä¸€æ­¥ä¹‹å‰ï¼Œå¤‡ä»½ä½ çš„æ•°æ®ã€‚

### è§£é” Bootloader

åœ¨æ–°æ¬¾ä¸‰æ˜Ÿæ‰‹æœºè®¾å¤‡ä¸Šè§£é”boot loader ï¼Œæœ‰ä¸€äº›çš„å‘Šè¯«ï¼š

    åœ¨å¼€å‘è€…é€‰é¡¹ä¸­å…è®¸OEM è§£é”
    é‡å¯åˆ° â€œdownloadâ€ æ¨¡å¼ï¼šæ‰‹æœºå…³æœºï¼Œç„¶åä½¿ç”¨ â€œdownloadæ¨¡å¼â€ç»„åˆé”®ã€‚
    é•¿æŒ‰éŸ³é‡+ æ¥è§£é”bootloaderã€‚ä¼šæ¸…é™¤ä½ çš„æ•°æ®ç„¶åè‡ªåŠ¨é‡å¯ã€‚

ä½ ä»¥ä¸ºæ•´å¥½äº†ï¼Œä½†å…¶å®æ²¡æœ‰ã€‚ Samsung æœ‰ VaultKeeper, æ„æ€æ˜¯ï¼Œbootloader ä¼šæ‹’ç»æ‰€æœ‰çš„éå®˜æ–¹çš„åˆ†åŒºã€‚é™¤éVaultKeeper æ˜ç¡®å…è®¸ã€‚

    Go through the initial setup. Skip through all the steps since data will be wiped again later when we are installing Magisk. Connect the device to Internet during the setup.
    Enable developer options, and confirm that the OEM unlocking option exists and is grayed out. This means the VaultKeeper service has unleashed the bootloader.
    Your bootloader now accepts unofficial images in download mode

### Instructions

    Use either samfirm.js, Frija, or Samloader to download the latest firmware zip of your device directly from Samsung servers.
    Unzip the firmware and copy the AP tar file to your device. It is normally named as AP_[device_model_sw_ver].tar.md5
    Press the Install button in the Magisk card
    If your device does NOT have boot ramdisk, make sure â€œRecovery Modeâ€ is checked in options.
    In most cases it should already be automatically checked.
    Choose â€œSelect and Patch a Fileâ€ in method, and select the AP tar file
    The Magisk app will patch the whole firmware file to [Internal Storage]/Download/magisk_patched_[random_strings].tar
    Copy the patched tar file to your PC with ADB:
    adb pull /sdcard/Download/magisk_patched_[random_strings].tar
    DO NOT USE MTP as it is known to corrupt large files.
    Reboot to download mode. Open Odin on your PC, and flash magisk_patched.tar as AP, together with BL, CP, and CSC (NOT HOME_CSC because we want to wipe data) from the original firmware. This could take a while (>10 mins).
    After Odin is done, your device should reboot. You may continue with standard initial setup.
    If you are stuck in a bootloop, agree to do a factory reset if promted.
    If your device does NOT have boot ramdisk, reboot to recovery now to boot Android with Magisk (reason stated in Magisk in Recovery).
    Although Magisk is installed, it still need some additional setup. Please connect to the Internet.
    Install the latest Magisk app and launch the app. It should show a dialog asking for additional setups. Let it do its job and the app will automatically reboot your device.
    Voila! Enjoy Magisk ğŸ˜ƒ

### Additional Notes

    Never, ever try to restore either boot or recovery partitions back to stock! You can easily brick your device by doing so, and the only way out is to do a full Odin restore with data wipe.
    To upgrade your device with a new firmware, NEVER directly use the stock AP tar file with reasons mentioned above. Always pre-patch AP in the Magisk app before flashing in Odin.
    Use HOME_CSC to preserve your data when doing a firmware upgrade in the future. Using CSC is only necessary for the initial Magisk installation.
    Never just flash only AP, or else Odin can shrink your /data filesystem. Flash full AP + BL + CP + HOME_CSC when upgrading.

## Huawei

é¢å…·ä¸å†æ”¯æŒåä¸ºçš„æ–°æœºå‹ï¼Œå› ä¸ºæ— æ³•è§£blé”ã€‚æœ€é‡è¦çš„æ˜¯åä¸ºä¸éµå¾ªå®‰å“æ ‡å‡†åˆ†åŒºç­–ç•¥ã€‚The following are just some general guidance.

ä½¿ç”¨éº’éºŸå¤„ç†å™¨çš„åä¸ºè®¾å¤‡æ‹¥æœ‰ä¸åŒåˆ†åŒºæ–¹æ³•ã€‚é¢å…·ä¸€èˆ¬å®‰è£…åˆ°å¯åŠ¨åˆ†åŒºï¼Œä½†æ˜¯åä¸ºæ²¡æœ‰è¿™ä¸ªåˆ†åŒºã€‚

Generally, follow Patching Images with some differences from the original instructions:

    After downloading your firmware zip (you may find a lot in Huawei Firmware Database), you have to extract images from UPDATE.APP in the zip with Huawei Update Extractor (Windows only!)
    Regarding patching images:
        å¦‚æœä½ çš„è®¾å¤‡æœ‰ramdiskï¼Œä½¿ç”¨ramdisk.img è€Œä¸æ˜¯boot.imgã€‚
        å¦‚æœä½ çš„è®¾å¤‡æ²¡æœ‰ramdiskï¼Œä½¿ç”¨recovery_ramdis.imgï¼ˆå°±é•¿è¿™æ ·ï¼Œä¸æ˜¯è¾“å…¥é”™è¯¯ï¼‰è€Œä¸æ˜¯recovery.imgã€‚
    When flashing the image back with fastboot
        If you patched RAMDISK.img, flash with command fastboot flash ramdisk magisk_patched.img
        If you patched RECOVERY_RAMDIS.img, flash with command fastboot flash recovery_ramdisk magisk_patched.img

This site is open source. Improve this page.
